#!/usr/bin/env bash

set -Eeuo pipefail

SCRIPT_DIR="$(cd -- "$(dirname -- "$0")" && pwd)"
ROOT_DIR="$(cd -- "${SCRIPT_DIR}/.." && pwd)"
. "${ROOT_DIR}/lib/common"

! command -v git-filter-repo &> /dev/null && die "git-filter-repo not found"
! command -v column &> /dev/null && die "column not found"

main() {
  test "$#" -lt 1 && die "No command passed"
  local cmd="$1"; shift
  local cmd_path="${ROOT_DIR}/cmds/${cmd}"

  ! test -f "${cmd_path}" && die "Command '${cmd}' not found"

  CMD="$0 ${cmd}" exec "${cmd_path}" "$@"
}

main "$@"
